import os
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É .env
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
env_path = os.path.join(BASE_DIR, ".env")
load_dotenv(env_path, override=True)

# Debug: Check if vars loaded
if not os.getenv("BOT_TOKEN"):
    print(f"DEBUG: .env path: {env_path}")
    print(f"DEBUG: .env exists: {os.path.exists(env_path)}")
    print("DEBUG: BOT_TOKEN not found in env!")

# ============================================
# –ù–ê–°–¢–†–û–ô–ö–ò TELEGRAM –ë–û–¢–ê
# ============================================

# –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
BOT_TOKEN = os.getenv("BOT_TOKEN")

# ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—Å–ø–∏—Å–æ–∫ ID)
admin_ids_str = os.getenv("ADMIN_IDS", "")
ADMIN_IDS = [int(id_str) for id_str in admin_ids_str.split(",") if id_str.strip()]

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤
PINNED_NUMBERS_FILE = "data/pinned_numbers.json"

# ============================================
# –ù–ê–°–¢–†–û–ô–ö–ò –ë–ê–ó–´ –î–ê–ù–ù–´–•
# ============================================

# –î–∞–Ω–Ω—ã–µ –∏–∑ wp-config.php
DB_CONFIG = {
    "host": os.getenv("DB_HOST", "localhost"),
    "database": os.getenv("DB_NAME"),
    "user": os.getenv("DB_USER"),
    "password": os.getenv("DB_PASSWORD"),
    "port": int(os.getenv("DB_PORT", 3306)),
    "charset": "utf8mb4",
    "autocommit": True,
}

# –ü—Ä–µ—Ñ–∏–∫—Å —Ç–∞–±–ª–∏—Ü (—Ä–µ–∞–ª—å–Ω—ã–π, –∞ –Ω–µ –∏–∑ wp-config.php)
TABLE_PREFIX = os.getenv("TABLE_PREFIX", "wp_")

# ============================================
# –ù–ê–°–¢–†–û–ô–ö–ò WORDPRESS API
# ============================================

# WordPress REST API –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–µ–π
WORDPRESS_CONFIG = {
    "enabled": True,  # –í–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å WordPress API
    "site_url": os.getenv("WP_SITE_URL"),
    "username": os.getenv("WP_USERNAME"),  # –û—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    "password": os.getenv("WP_PASSWORD"),  # –û—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    "api_key": os.getenv("WP_API_KEY"),  # ‚úÖ –ù–û–í–´–ô API –ö–õ–Æ–ß
    "verify_ssl": True,  # –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
    "timeout": 10,  # –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    "retry_attempts": 3,  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –æ—à–∏–±–∫–µ
    "cache_ttl": 30,  # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
}


# ============================================
# –ù–ê–°–¢–†–û–ô–ö–ò –ö–õ–ò–ù–ò–ö–ò
# ============================================

CLINIC_INFO = {
    "name": "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä Diason",
    "address": "–≥. –¢–∞—à–∫–µ–Ω—Ç, —É–ª –ë—É—é–∫ –ò–ø–∞–∫ –ô—É–ª–∏, 276",
    "phone": "+998(55) 516 11 00, +998(55) 516 18 18",
    "email": "diason2new@gmail.com",
    "working_hours": "09:00-15:00 (–í—Å –≤—ã—Ö–æ–¥–Ω–æ–π)",
    "website": "https://diason.uz",
}

# –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤—Ä–∞—á–µ–π
WORKING_HOURS = {
    "start": "09:00",
    "end": "14:15",
    "lunch_start": "00:00",
    "lunch_end": "00:00",
}

# –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–∞ (–≤ –º–∏–Ω—É—Ç–∞—Ö)
APPOINTMENT_DURATION = 45

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ –¥–µ–Ω—å –Ω–∞ –æ–¥–Ω–æ–≥–æ –≤—Ä–∞—á–∞
MAX_APPOINTMENTS_PER_DAY = 16

# ============================================
# –ù–ê–°–¢–†–û–ô–ö–ò –ë–û–¢–ê
# ============================================

BOT_SETTINGS = {
    "log_file": "clinic_bot.log",
    "debug": False,
    "enable_logging": True,
    "log_level": "INFO",  # DEBUG, INFO, WARNING, ERROR
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ConversationHandler
    "conversation_timeout": 300,  # 5 –º–∏–Ω—É—Ç —Ç–∞–π–º–∞—É—Ç –¥–∏–∞–ª–æ–≥–∞
    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤–ø–µ—Ä–µ–¥
    "days_forward": 7,
    # –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Å–µ–∫—É–Ω–¥—ã)
    "polling_interval": 0.5,
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    "max_doctors_per_page": 10,
    "max_appointments_per_user": 5,
    "same_day_booking_deadline": 11, # –ß–∞—Å –¥–Ω—è (0-23), –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–ª—å–∑—è –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
}

# ============================================
# –°–û–û–ë–©–ï–ù–ò–Ø –ë–û–¢–ê
# ============================================

MESSAGES = {
    "welcome": "üëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {user_name}!\n\nüè• –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä Diason!",
    "help": (
        "üÜò <b>–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞</b>\n\n"
        "–î–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ –ø—Ä–∏–µ–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /book\n\n"
        "–î—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã:\n"
        "‚Ä¢ /start - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ /doctors - –ù–∞—à–∏ –≤—Ä–∞—á–∏\n"
        "‚Ä¢ /info - –û –∫–ª–∏–Ω–∏–∫–µ\n"
        "‚Ä¢ /status - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã\n"
        "‚Ä¢ /help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞"
    ),
    "appointment_success": (
        "‚úÖ <b>–ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!</b>\n\n"
        "üìã <b>–î–µ—Ç–∞–ª–∏ –∑–∞–ø–∏—Å–∏:</b>\n"
        "üë§ –ü–∞—Ü–∏–µ–Ω—Ç: {user_name}\n"
        "üìû –¢–µ–ª–µ—Ñ–æ–Ω: {user_phone}\n"
        "üë®‚Äç‚öïÔ∏è –í—Ä–∞—á: {doctor_name}\n"
        "üìÖ –î–∞—Ç–∞: {appointment_date}\n"
        "üïê –í—Ä–µ–º—è: {appointment_time}\n\n"
        "üí° <b>–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</b>\n"
        "‚Ä¢ –ü—Ä–∏—Ö–æ–¥–∏—Ç–µ –∑–∞ 10-15 –º–∏–Ω—É—Ç –¥–æ –ø—Ä–∏–µ–º–∞\n"
        "‚Ä¢ –ü—Ä–∏ —Å–µ–±–µ –∏–º–µ—Ç—å –ø–∞—Å–ø–æ—Ä—Ç\n"
        "‚Ä¢ –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ —Å–æ–æ–±—â–∏—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ\n\n"
        "üè• <b>–ñ–¥–µ–º –≤–∞—Å –≤ –∫–ª–∏–Ω–∏–∫–µ!</b>"
    ),
    "error": "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",
}

# ============================================
# –ö–õ–ê–í–ò–ê–¢–£–†–´
# ============================================

KEYBOARDS = {
    "main_menu": [
        ["üìÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∏–µ–º", "üë®‚Äç‚öïÔ∏è –ù–∞—à–∏ –≤—Ä–∞—á–∏"],
        ["üè• –û –∫–ª–∏–Ω–∏–∫–µ", "üÜò –ü–æ–º–æ—â—å"],
    ],
    "days_of_week": ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"],
}

# ============================================
# –ü–£–¢–ò –ö –§–ê–ô–õ–ê–ú
# ============================================

PATHS = {"log_dir": "logs", "data_dir": "data", "backup_dir": "backups"}

# –≠–∫—Å–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
__all__ = [
    "BOT_TOKEN",
    "DB_CONFIG",
    "TABLE_PREFIX",
    "CLINIC_INFO",
    "WORKING_HOURS",
    "BOT_SETTINGS",
    "MESSAGES",
    "KEYBOARDS",
    "ADMIN_IDS",
]

